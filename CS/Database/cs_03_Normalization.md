# Normalization

> 01_Normalization?
>
> 02_단계별 정규화 절차

출처 : 

https://code-lab1.tistory.com/48

https://github.com/Youji-Sung/CS-study/tree/master/%EB%8B%A4%EC%9D%B8



## 01_Normalization?

테이블 간의 중복된 데이터를 허용하지 않는 것

- **정규화 X :**
  - 데이터의 중복이 많아져 트랜잭션에서 중복된 데이터를 모두 변경해야 하므로 
    성능이 떨어지게 됨
- **정규화가 과할 경우**
  - 데이터를 가져올 때 조인이 많이 필요하게 됨



## 02_단계별 정규화

> 1NF , 2NF , 3NF
>
> BCNF (Boyce-Codd Normal Form)
>
> 4NF, 5NF

### 제 1정규화

| 회원번호 | 이름     | 프로그램            |
| -------- | -------- | ------------------- |
| 1        | 브라이언 | 힙합, 요가, 러닝    |
| 2        | 이안     | 힙합, 헬스,베드민턴 |

- 단점

  - 힙합을 수강한 사람을 찾기 힘들어진다.

  - 프로그램명 수정을 하기 어려워진다.

  - 즉 조회하는 것이 힘들어진다.

    

**수정**

| 회원번호 | 이름     | 프로그램 |
| -------- | -------- | -------- |
| 1        | 브라이언 | 힙합     |
| 1        | 브라이언 | 요가     |
| 1        | 브라이언 | 러닝     |
| 2        | 이안     | 힙합     |
| 2        | 이안     | 헬스     |
| 2        | 이안     | 베드민턴 |

- 릴레이션의 모든 속성 값이 원자값을 갖는다



**규칙**

- 각 컬럼이 하나의 속성만을 가져야한다.
- 하나의 컬럼은 같은 종류나 타입의 값을 가진다.
- 각 컬럼이 유일한 이름을 가져야한다.
- 칼럼의 순서가 상관없어야한다.



### 제 2정규화

| 회원번호 | 이름     | 프로그램 | 가격  |
| -------- | -------- | -------- | ----- |
| 1        | 브라이언 | 힙합     | 8000  |
| 1        | 브라이언 | 요가     | 7000  |
| 1        | 브라이언 | 러닝     | 6000  |
| 2        | 이안     | 힙합     | 8000  |
| 2        | 이안     | 헬스     | 10000 |
| 2        | 이안     | 베드민턴 | 5000  |

- 단점
  - 힙합 가격을 7000으로 수정하려면 어떻게 해야하는가?
  - 만약 힙합 수강생이 10000이상일 경우 10000이상을 다 수정해야한다.



**수정**

| 회원번호 | 이름     | 프로그램 |
| -------- | -------- | -------- |
| 1        | 브라이언 | 힙합     |
| 1        | 브라이언 | 요가     |
| 1        | 브라이언 | 러닝     |
| 2        | 이안     | 힙합     |
| 2        | 이안     | 헬스     |
| 2        | 이안     | 베드민턴 |

| 프로그램 | 가격  |
| -------- | ----- |
| 힙합     | 8000  |
| 요가     | 7000  |
| 러닝     | 6000  |
| 헬스     | 10000 |
| 베트민턴 | 5000  |

- 현재 테이블의 주제와 관련 없는 컬럼을 다른 테이블로 뺴는 작업
  - 단점
    - 프로그램 가격을 알기 위해서는 조인을 해주어야 한다.

이론적인 내용의 2정규화

- 정의
  - Partial Dependency를 제거한 테이블
  - Partial Dependency란?
    - 하나의 composite primary key에 종속된 컬럼

- composite primary key란?
  - pk가 없을때 컬럼 두개를 합칠때 pk역할을 하는 경우
  - 즉 한 사람이 똑같은 프로그램은 못듣는 다는 가정하에 (회원번호, 프로그램)은 pk로 사용할 수 있음
  - 이것을 합치면 composite primary key라고 한다.

- partial dependency란?
  - 하나의 composite primary key에 종속된 컬럼
  - 즉 (회원번호, 프로그램)를 pk로 두었을 때 이것에 종속 
    => 즉 composite primary key가 변경되면 같이 변경되어야하는 컬럼

**규칙**

- 1정규형을 만족해야함
- Partial Dependency를 제거한 테이블



### 제 3 정규화

| 프로그램 | 가격  | 강사   | 출신대학 |
| -------- | ----- | ------ | -------- |
| 힙합     | 8000  | 김덕배 | 서울대   |
| 런닝     | 6000  | 이곽덕 | 연세대   |
| 요가     | 7000  | 이곽덕 | 연세대   |
| 헬스     | 10000 | 김상필 | 고려대   |
| 배드민턴 | 5000  | 김상필 | 고려대   |

- 제 2 정규형을 만족하고, 데이블 내의 모든 속성이 키에만 의존하며 다른 후보키에 의존하지 않는다.
- 정규화가 잘 된 테이블은 갑-을 관계만 있는 것
  - 위 table은 갑(프로그램) - 을(강사) - 병(출신대학)
  - 따라서 이를 갑을 관계로 바꾸어준다.



| 프로그램 | 가격  | 강사   |
| -------- | ----- | ------ |
| 힙합     | 8000  | 김덕배 |
| 런닝     | 6000  | 이곽덕 |
| 요가     | 7000  | 이곽덕 |
| 헬스     | 10000 | 김상필 |
| 배드민턴 | 5000  | 김상필 |

| 강사   | 출신대학 |
| ------ | -------- |
| 김덕배 | 서울대   |
| 이곽덕 | 연세대   |
| 김상필 | 고려대   |

- 일반 컬럼에만 종속된 컬럼은 다른 테이블로 빼기

- 장점

  - 출신학교가 바뀔떄 한번에 수정가능하다.

    

- 단점

  - 출신학교를 알기 위해선 join을 해야한다.



**규칙**

- 제2정규형을 만족해야한다.
- 키본키를 제외한 속성들 간의 Trasitive Dependency가 없어야한다.





