# 멀티코어 CPU 이야기

페이지: https://minjang.github.io/about/

## 1. 프로그래머가 프로세서도 알아야 하나?

- CPU는 하나의 집적회로로 만들어진 마이크로프로세서로 표현하는 것이 더 바람직하다

##### 프로세서를 공부하는 이유

- 프로그램을 더 빠르고 안전하게 만드는 데 쓸 수 있는 여러 기발한 알고리즘으로 가득 차 있음
- 더 빠르고 좋은 프로그램을 만들려면 최신 병렬 프로세서를 보다 적극적으로 활용해야한다.
  즉 프로그래머는 이러한 변화에 적극적으로 대응해야 한다.

- 프로세서는 실제 구현만 하드웨어에서 이루어지는 것 뿐 완벽하게 프로그래밍을 하는 것과 같다
  수많은 명령을 어떻게 하면 빠르게 처리할 수 있을까 라는 문제를 프로그래밍하는 것과 완전히 같다



## 2. 프로세서의 언어: 명령어 집합 구조

#### 컴파일러

- 프로그래머가 이해하는 언어를 포로세서가 쓰는 기계어로 번역해주는 장치
- 프로그래머가 길고 장황하게 말을 늘어 놓으면 요점만 간추려 프로세서에 전달
- 어법에 어긋난 말을 하면 컴파일러는 정확하게 가려준다



### 프로그래머가 보는 프로세서

디버거 상태

#### 용어

- 레지스터: 계산을 하기 위해 필수적으로 필요한 작은 용량이지만 매우 빠른 임시 기억 장치. 현대 컴퓨터는 모든 계산을 메모리에서 레지스터로 값을 옮겨온 후 해야한다. 

- 컴푸터 구조적 상태(architerctureral state)
  현재 프로세서(cpu)가 수행 중인 프로세스의 상태를 지닌 각종 레지스터(임기 기억 장치)의 값들을 가르키는 것



### 프로세서의 언어: 명령어 집합 구조

##### Instruction Set Architecture(ISA): 명령어 집합 구조

- 컴파일러가 없다면 프로그래머는 프로세서가 이해하는 **기계어 혹은 어셈블리어**를 이용해야 컴퓨터에 작업을 지시할 수 있음 ==> 이 기계어를 ISA라고 한다.

- 프로그래머와 프로세서(cpu)가 직접적으로 소통할 수 있는 언어

- 특징

  - 프로그래밍 방법론을 정의할 뿐만 아니라 프로세서 구현의 많은 부분도 결정

  - 프로세서의 내부구조 달라도 x86 ==> 문제없이 프로그램 작동

  - ISA가 다른 프로세서, x86 ==> 바로 작동 할 수 없음 ==> .NET프레임워크 등은 이 문제를 해결하려고 하고 있음



##### instruction: 인스트럭션

- 명령어
- 프로세서가 이해하는 명령어 하나하나를 인스트럭션이라고 부름

- 명령어의 종류
  - 기본적인 사칙 연산과 논리 연산
  - 메모리를 쓰고(store) 읽는(load) 명령
  - 프로그램의 실행 흐름을 제어하는 분기 및 호출 명령(if/goto, call/return)
  - 시스템 내부를 제어하거나 상태를 관찰하는 명령등



ex) A += 7을 x86의 언어로 표현해보자

add dword ptr [A], 0x07

0x83 0x45 0xF8 0x07

- add 와 0x07 쉬움
- dword ptr [A] 
  - A는 변수 A의 주소 값
  - dword ptr 은 주소 값을 4바이트 정수형으로 해석하라 라는 뜻
- 요약: ptrA가 A의 주소를 감고 있다고 할때, ptrA = ptrA +7로 이해한다
- 0x83 0x45로 시작하는 16진수는 이 덧셈 명령이 실제로 프로세서로 전달될 때 표현되는 값



### RISC와 CISC로 알아보는 명령어 집합 구조

- 옛날에 메모리가 매우 비쌈 ==> 짧은 길이의 명령어에 많은 뜻을 함축 ==> 복잡



#### RISC

- 탄생 이유
  - CISC명령어 집합이 지워하는 모든 명령어와 주소 모드를 사용하지 않음
  - 일부만 사용
  - CISC는 가변길이므로 16비트 혹은 32비트 상수 피연산자를 쉽게 명령어에 표현
  - 조사해보니 13비트면 충분히 상수들 표현 가능 (-1, 10과 같은 작은 정수들이 자주나옴)

컴퓨터 구조 설계의 첫번째 원칙

- make common case fast ==> 자주있는 케이스를 빠르게 하라 ==> RISC 탄생



#### 대표적인 RISC, MIPS구조

- MIPS: 모든 명령어는 R(register), I(inmmedate)상수, J(jump) 타입 중 하나로 표현된다.



## 3. 프로세서의 기본 부품과 개념들

### 마이크로아키텍처

- 마이크로세서 하나를 만드는데 필요한 알고리즘 및 회로 수준의 구조 



#### 마이크로 프로세서 설계 2단계

- 마이크로 아카텍처 설계
  - 성능을 하능케  하는 알고리즘과 테크닉(시뮬레이터를 이용)
- 로직 설계

RTL(Register Transfer Language) :  마이크로아키텍처 알고리즘

HDL(Hardware Description Language): 

- 실제 하드웨어 구현에 적합한지 가다듬어 최종적인 언어인 hdl언어로 바꾼다
- 전자공학의 영역: 효율적인 회로로 만드는 기술 필요



### 산술 논리 장치(ALU): 프로세서 속의 계산기

























